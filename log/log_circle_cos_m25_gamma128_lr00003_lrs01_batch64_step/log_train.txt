==========
Args:Namespace(arch='resnet50', cuhk03_classic_split=False, cuhk03_labeled=False, dataset='market1501', eval_step=20, evaluate=False, gamma=0.1, gpu_devices='1', height=256, htri_only=False, lr=0.0003, margin=0.3, max_epoch=200, num_instances=4, optim='adam', print_freq=10, resume='', root='/data/clyf/Datasets/market1501', save_dir='log/log_circle_cos_m25_gamma128_lr00003_lrs01_batch64_step', seed=1, split_id=0, start_epoch=0, start_eval=0, stepsize=60, test_batch=32, train_batch=64, use_cpu=False, use_metric_cuhk03=False, weight_decay=0.0005, width=128, workers=4)
==========
Currently using GPU 1
Initializing dataset market1501
=> Market1501 loaded
Dataset statistics:
  ------------------------------
  subset   | # ids | # images
  ------------------------------
  train    |   751 |    12936
  query    |   750 |     3368
  gallery  |   751 |    15913
  ------------------------------
  total    |  1501 |    32217
  ------------------------------
Initializing model: resnet50
Model size: 25.04683M
==> Start training
Epoch: [1][10/46]	Time 0.162 (0.349)	Data 0.003 (0.070)	Loss 64.0363 (66.3954)	
Epoch: [1][20/46]	Time 0.174 (0.260)	Data 0.003 (0.036)	Loss 67.8072 (65.6939)	
Epoch: [1][30/46]	Time 0.173 (0.230)	Data 0.009 (0.025)	Loss 63.9440 (65.2844)	
Epoch: [1][40/46]	Time 0.169 (0.215)	Data 0.003 (0.020)	Loss 66.3197 (64.9364)	
Epoch: [2][10/46]	Time 0.190 (0.244)	Data 0.003 (0.071)	Loss 62.8722 (63.3769)	
Epoch: [2][20/46]	Time 0.174 (0.206)	Data 0.003 (0.037)	Loss 60.6765 (62.6178)	
Epoch: [2][30/46]	Time 0.177 (0.196)	Data 0.003 (0.026)	Loss 58.6888 (62.1904)	
Epoch: [2][40/46]	Time 0.172 (0.190)	Data 0.003 (0.020)	Loss 67.0824 (62.0594)	
Epoch: [3][10/46]	Time 0.165 (0.234)	Data 0.003 (0.063)	Loss 59.8754 (60.3701)	
Epoch: [3][20/46]	Time 0.178 (0.204)	Data 0.003 (0.034)	Loss 55.8613 (60.7703)	
Epoch: [3][30/46]	Time 0.175 (0.193)	Data 0.003 (0.023)	Loss 61.4704 (61.2167)	
Epoch: [3][40/46]	Time 0.172 (0.189)	Data 0.003 (0.018)	Loss 61.2473 (61.4048)	
Epoch: [4][10/46]	Time 0.182 (0.236)	Data 0.003 (0.068)	Loss 57.0233 (59.3193)	
Epoch: [4][20/46]	Time 0.170 (0.205)	Data 0.003 (0.036)	Loss 66.0777 (60.7027)	
Epoch: [4][30/46]	Time 0.164 (0.194)	Data 0.003 (0.025)	Loss 60.5613 (60.1555)	
Epoch: [4][40/46]	Time 0.164 (0.187)	Data 0.003 (0.019)	Loss 57.8297 (59.7721)	
Epoch: [5][10/46]	Time 0.167 (0.237)	Data 0.003 (0.066)	Loss 59.8094 (56.1688)	
Epoch: [5][20/46]	Time 0.196 (0.206)	Data 0.003 (0.035)	Loss 66.3487 (57.0214)	
Epoch: [5][30/46]	Time 0.166 (0.194)	Data 0.003 (0.024)	Loss 56.0242 (58.1194)	
Epoch: [5][40/46]	Time 0.167 (0.188)	Data 0.003 (0.019)	Loss 56.4954 (58.5275)	
Epoch: [6][10/46]	Time 0.181 (0.240)	Data 0.003 (0.065)	Loss 56.5008 (55.6142)	
Epoch: [6][20/46]	Time 0.181 (0.205)	Data 0.004 (0.034)	Loss 51.0064 (55.3703)	
Epoch: [6][30/46]	Time 0.168 (0.194)	Data 0.003 (0.023)	Loss 55.9404 (55.6053)	
Epoch: [6][40/46]	Time 0.169 (0.189)	Data 0.003 (0.018)	Loss 54.6661 (55.8371)	
Epoch: [7][10/46]	Time 0.178 (0.260)	Data 0.003 (0.088)	Loss 58.3130 (56.3533)	
Epoch: [7][20/46]	Time 0.166 (0.216)	Data 0.003 (0.045)	Loss 50.5761 (55.0199)	
Epoch: [7][30/46]	Time 0.172 (0.201)	Data 0.004 (0.031)	Loss 50.5767 (53.9907)	
Epoch: [7][40/46]	Time 0.174 (0.193)	Data 0.002 (0.024)	Loss 51.4340 (53.7845)	
Epoch: [8][10/46]	Time 0.174 (0.240)	Data 0.002 (0.069)	Loss 54.4614 (54.1763)	
Epoch: [8][20/46]	Time 0.180 (0.206)	Data 0.003 (0.036)	Loss 55.3603 (53.5344)	
Epoch: [8][30/46]	Time 0.178 (0.196)	Data 0.003 (0.025)	Loss 59.5469 (52.0969)	
Epoch: [8][40/46]	Time 0.168 (0.190)	Data 0.003 (0.019)	Loss 56.8665 (52.6020)	
Epoch: [9][10/46]	Time 0.184 (0.245)	Data 0.003 (0.075)	Loss 59.1265 (53.3521)	
Epoch: [9][20/46]	Time 0.165 (0.208)	Data 0.003 (0.039)	Loss 47.3399 (52.2655)	
Epoch: [9][30/46]	Time 0.174 (0.196)	Data 0.003 (0.027)	Loss 53.4713 (51.7385)	
Epoch: [9][40/46]	Time 0.168 (0.189)	Data 0.003 (0.021)	Loss 52.5732 (51.9467)	
Epoch: [10][10/46]	Time 0.167 (0.246)	Data 0.003 (0.078)	Loss 43.1483 (51.7832)	
Epoch: [10][20/46]	Time 0.176 (0.208)	Data 0.002 (0.041)	Loss 47.3146 (48.1427)	
Epoch: [10][30/46]	Time 0.166 (0.197)	Data 0.003 (0.028)	Loss 49.2770 (47.8259)	
Epoch: [10][40/46]	Time 0.167 (0.190)	Data 0.003 (0.022)	Loss 44.3359 (48.0016)	
Epoch: [11][10/46]	Time 0.169 (0.243)	Data 0.003 (0.074)	Loss 51.2115 (50.1311)	
Epoch: [11][20/46]	Time 0.175 (0.209)	Data 0.003 (0.038)	Loss 49.1123 (48.5940)	
Epoch: [11][30/46]	Time 0.167 (0.197)	Data 0.003 (0.026)	Loss 48.8391 (47.7031)	
Epoch: [11][40/46]	Time 0.171 (0.191)	Data 0.003 (0.021)	Loss 44.3682 (47.9533)	
Epoch: [12][10/46]	Time 0.173 (0.233)	Data 0.003 (0.062)	Loss 45.1673 (48.3209)	
Epoch: [12][20/46]	Time 0.169 (0.203)	Data 0.003 (0.033)	Loss 42.7256 (46.4983)	
Epoch: [12][30/46]	Time 0.171 (0.192)	Data 0.003 (0.023)	Loss 47.1169 (46.1651)	
Epoch: [12][40/46]	Time 0.169 (0.187)	Data 0.003 (0.018)	Loss 44.4527 (45.8611)	
Epoch: [13][10/46]	Time 0.168 (0.235)	Data 0.003 (0.067)	Loss 49.6806 (45.4387)	
Epoch: [13][20/46]	Time 0.185 (0.206)	Data 0.015 (0.036)	Loss 40.2990 (46.0649)	
Epoch: [13][30/46]	Time 0.175 (0.194)	Data 0.003 (0.025)	Loss 35.3060 (46.4753)	
Epoch: [13][40/46]	Time 0.176 (0.188)	Data 0.003 (0.019)	Loss 51.4452 (46.2828)	
Epoch: [14][10/46]	Time 0.177 (0.242)	Data 0.003 (0.070)	Loss 41.1385 (44.8171)	
Epoch: [14][20/46]	Time 0.188 (0.207)	Data 0.003 (0.036)	Loss 44.2476 (44.7285)	
Epoch: [14][30/46]	Time 0.185 (0.197)	Data 0.003 (0.025)	Loss 43.0663 (45.0824)	
Epoch: [14][40/46]	Time 0.167 (0.191)	Data 0.003 (0.020)	Loss 47.6558 (45.3286)	
Epoch: [15][10/46]	Time 0.174 (0.248)	Data 0.003 (0.075)	Loss 36.1582 (38.0666)	
Epoch: [15][20/46]	Time 0.186 (0.211)	Data 0.003 (0.039)	Loss 45.2118 (41.2993)	
Epoch: [15][30/46]	Time 0.183 (0.199)	Data 0.004 (0.027)	Loss 34.6238 (42.4184)	
Epoch: [15][40/46]	Time 0.174 (0.193)	Data 0.003 (0.021)	Loss 46.8607 (43.0794)	
Epoch: [16][10/46]	Time 0.175 (0.240)	Data 0.003 (0.064)	Loss 45.7480 (41.7005)	
Epoch: [16][20/46]	Time 0.173 (0.205)	Data 0.003 (0.034)	Loss 40.0797 (41.5604)	
Epoch: [16][30/46]	Time 0.173 (0.194)	Data 0.003 (0.023)	Loss 48.6365 (42.7940)	
Epoch: [16][40/46]	Time 0.169 (0.187)	Data 0.003 (0.018)	Loss 38.1243 (42.4003)	
Epoch: [17][10/46]	Time 0.167 (0.237)	Data 0.003 (0.069)	Loss 33.4288 (38.2505)	
Epoch: [17][20/46]	Time 0.167 (0.207)	Data 0.004 (0.036)	Loss 34.8373 (37.2579)	
Epoch: [17][30/46]	Time 0.163 (0.195)	Data 0.003 (0.025)	Loss 43.6445 (38.5044)	
Epoch: [17][40/46]	Time 0.168 (0.189)	Data 0.003 (0.020)	Loss 40.2406 (39.9878)	
Epoch: [18][10/46]	Time 0.169 (0.226)	Data 0.002 (0.059)	Loss 36.0739 (39.8888)	
Epoch: [18][20/46]	Time 0.175 (0.199)	Data 0.003 (0.031)	Loss 26.8105 (39.0004)	
Epoch: [18][30/46]	Time 0.175 (0.190)	Data 0.003 (0.022)	Loss 40.4117 (38.7486)	
Epoch: [18][40/46]	Time 0.170 (0.185)	Data 0.003 (0.017)	Loss 45.4345 (39.6087)	
Epoch: [19][10/46]	Time 0.167 (0.245)	Data 0.003 (0.075)	Loss 45.5793 (41.6307)	
Epoch: [19][20/46]	Time 0.172 (0.208)	Data 0.003 (0.039)	Loss 40.9357 (37.8408)	
Epoch: [19][30/46]	Time 0.171 (0.196)	Data 0.003 (0.027)	Loss 37.9762 (36.9470)	
Epoch: [19][40/46]	Time 0.168 (0.190)	Data 0.003 (0.021)	Loss 40.6975 (37.6205)	
Epoch: [20][10/46]	Time 0.171 (0.230)	Data 0.003 (0.061)	Loss 30.0174 (38.2384)	
Epoch: [20][20/46]	Time 0.183 (0.201)	Data 0.007 (0.032)	Loss 38.7707 (38.1698)	
Epoch: [20][30/46]	Time 0.177 (0.191)	Data 0.003 (0.023)	Loss 36.3028 (38.7988)	
Epoch: [20][40/46]	Time 0.167 (0.186)	Data 0.003 (0.018)	Loss 38.5027 (39.1899)	
==> Test
Extracted features for query set, obtained 3368-by-2048 matrix
Extracted features for gallery set, obtained 15913-by-2048 matrix
==> BatchTime(s)/BatchSize(img): 0.023/32
Computing CMC and mAP
Results ----------
mAP: 30.2%
CMC curve
Rank-1  : 53.9%
Rank-5  : 75.2%
Rank-10 : 81.7%
Rank-20 : 87.1%
------------------
Epoch: [21][10/46]	Time 0.164 (0.238)	Data 0.002 (0.068)	Loss 26.4909 (30.5747)	
Epoch: [21][20/46]	Time 0.181 (0.204)	Data 0.006 (0.036)	Loss 23.4471 (31.3035)	
Epoch: [21][30/46]	Time 0.164 (0.191)	Data 0.003 (0.025)	Loss 36.8322 (33.6356)	
Epoch: [21][40/46]	Time 0.170 (0.185)	Data 0.003 (0.019)	Loss 36.7932 (34.8356)	
Epoch: [22][10/46]	Time 0.164 (0.234)	Data 0.003 (0.072)	Loss 26.1305 (36.7608)	
Epoch: [22][20/46]	Time 0.164 (0.201)	Data 0.003 (0.037)	Loss 33.3059 (37.0538)	
Epoch: [22][30/46]	Time 0.177 (0.191)	Data 0.003 (0.026)	Loss 32.3809 (35.9490)	
Epoch: [22][40/46]	Time 0.162 (0.185)	Data 0.002 (0.020)	Loss 34.2320 (35.7121)	
Epoch: [23][10/46]	Time 0.167 (0.244)	Data 0.003 (0.071)	Loss 28.9862 (33.0714)	
Epoch: [23][20/46]	Time 0.178 (0.207)	Data 0.003 (0.037)	Loss 41.5808 (33.6895)	
Epoch: [23][30/46]	Time 0.182 (0.195)	Data 0.003 (0.026)	Loss 36.1914 (33.2681)	
Epoch: [23][40/46]	Time 0.162 (0.189)	Data 0.003 (0.020)	Loss 36.1580 (33.3336)	
Epoch: [24][10/46]	Time 0.180 (0.253)	Data 0.003 (0.086)	Loss 43.5471 (36.6970)	
Epoch: [24][20/46]	Time 0.171 (0.212)	Data 0.003 (0.045)	Loss 44.5011 (35.6616)	
Epoch: [24][30/46]	Time 0.169 (0.199)	Data 0.003 (0.031)	Loss 36.0486 (35.2806)	
Epoch: [24][40/46]	Time 0.166 (0.191)	Data 0.002 (0.024)	Loss 35.1985 (35.4424)	
